# spm 的困境

> seajs 这里关注的人多圈子大，发这里攒攒人气。

## 历史

spm 发展到现在已经很长时间了。

1. 最初的 spm 和 seajs 配套开发，功能也主要是构建模块，玉伯来支付宝之前就已经存在了。
2. 来支付宝后开始做新版 spm，现在称之为 spm1（最新版本 1.7.x）。在这个版本的开发中定义了 CMD 模块的标准以及 transport 的标准，功能也大大的完善。有源的出现，但只是为解决模块之间处理依赖的问题。构建功能强大，支持多种场景。
3. 今年开发的 spm2 从定位上做了很大的调整： **spm 是一个包管理器**。spm 作为包管理器能让整个前端界互通起来，尊重别人的成果，分享你的成果，这也是开源的精神。现在业界前端的包管理器有 component，bower 等等。

## 现状

就算 spm 的定位发生了改版，但seajs 社区的问题仍然集中在构建，这个与 seajs 的设计是分不开的。

构建最多的问题是什么？生成的 id 与 seajs 请求的路径不匹配，应该每个新人都会掉坑里，偏右有总结过一篇文档 [#930](https://github.com/seajs/seajs/issues/930)

构建最关键的一步是 transport，简单点说就是把 define(factory) 改成 define(id, deps, factory)， [#426](https://github.com/seajs/seajs/issues/426) ，有些新人对 transport 不了解胡乱生成一个模块 id，这 id 又与 seajs 的配置不相符，这就是问题所在。不知道现在有多少人认为 spm 是一个构建工具。

问题还不只是这些，spm 会把模块上传到源上，源上的模块都是编译过的，所以模块的源码和包是耦合的（主要是 id 和 deps），这与大多数包管理工具的差别很大。比如现在源上的文件都是有版本号的，但是很多人不希望有版本号，这就没法处理了。

以上问题可能是很多人不愿使用源的理由。

源地址 [https://spmjs.org/](https://spmjs.org/)

## 未来

spm 还只是一个处理静态文件的工具，比较好的方案应该像 fis 一样把页面也管起来。比如分析静态文件，计算 seajs 的应该存放的路径，transport 时根据分析结果生成 id 和 deps，然后在页面上自动生成 seajs 以及配置文件。

源应该要发生改变，可以把源码传到源上，这样有足够的扩展性。当要使用的时候通过一个工具下载，处理依赖，构建。倾向于和 component 整合。

------

大半夜胡思乱想，思路比较乱，请拍砖。

